<div class="grid__wrapper">
    <igx-tree-grid igxPreventDocumentScroll #treeGrid [batchEditing]="true" [data]="data" primaryKey="ID"
        foreignKey="ParentID" [width]="'100%'" [height]="'500px'" [rowEditable]="true" [pinning]="pinningConfig"
        (formGroupCreated)="formCreateHandler($event)">
        <igx-column field="ID" header="ID" dataType="number" [editable]="false"></igx-column>
        <igx-column field="Age" header="Age" dataType="number" [editable]="true" required min="18" max="99"></igx-column>
        <igx-column field="Name" header="Full Name" dataType="string" [editable]="true" required></igx-column>
        <igx-column field="City" header="City" dataType="string" [editable]="true" required>
            <ng-template igxCellEditor let-cell="cell" >
                <igx-select [(ngModel)]="cell.editValue" [igxFocus]="true">
                    <igx-select-item *ngFor="let city of cities" [value]="city">
                        {{ city }}
                    </igx-select-item>
                </igx-select>
            </ng-template>
        </igx-column>
        <igx-column field="Country" header="Country" dataType="string" [editable]="true" required>
            <ng-template igxCellEditor let-cell="cell">
                <igx-select [(ngModel)]="cell.editValue" [igxFocus]="true">
                    <igx-select-item *ngFor="let country of countries" [value]="country">
                        {{ country }}
                    </igx-select-item>
                </igx-select>
            </ng-template> 
        </igx-column>
        <igx-column field="Title" header="Title" dataType="string" [editable]="true" required></igx-column>
        <igx-column field="HireDate" header="Hire Date" dataType="date" [editable]="true" required></igx-column>
        <igx-column field="OnPTO" header="On PTO" dataType="boolean" [editable]="true"></igx-column>
        <igx-column field="row_valid" header=" " [editable]="false" [dataType]="'number'" [pinned]="true" [width]="'150px'">
            <ng-template igxCell let-cell="cell">
                <div *ngIf="isRowValid(cell)" [igxTooltipTarget]="tooltipRef"  style="margin: 'auto';">
                    <img width="18" src="assets/images/grid/active.png"/>
                </div>
                <div *ngIf="!isRowValid(cell)" [igxTooltipTarget]="tooltipRef" style="margin: 'auto';">
                    <img width="18" src="assets/images/grid/expired.png"/>
                </div>
                <div #tooltipRef="tooltip" igxTooltip [style.width]="'max-content'">
                   <div *ngFor="let message of stateMessage(cell)">
                       {{message}}
                   </div>
                </div>
            </ng-template>
        </igx-column>
    </igx-tree-grid>
</div>

<button igxButton [disabled]="treeGrid.transactions.getAggregatedChanges(false).length < 1" (click)="commit()">Commit</button>
